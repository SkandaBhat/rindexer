# indexers

Indexers YAML config describes the indexers you wish to run.

:::info
You can have multiple indexers in a single YAML file.
:::

## name

The name of the indexer it should be unique to the YAML so you can not have 2 indexers with the same name in the same
YAML file.

```yaml [rindexer.yaml]
name: rETHIndexer
description: My first rindexer project
repository: https://github.com/joshstevens19/rindexer
networks:
- name: ethereum
  chainId: 1
  rpcUrl: https://mainnet.infura.io/v3/your-infura-key
storage:
  postgres:
    name: ${DATABASE_NAME}
    user: ${DATABASE_USER}
    password: ${DATABASE_PASSWORD}
    host: ${DATABASE_HOST}
    port: ${DATABASE_PORT}
  csv:
    path: ./generated_csv
indexers:
- name: MyFirstIndexerExample // [!code focus]
```

## contracts

The list of contracts to index for this indexer.

:::info
You can have multiple contracts in an indexer.
:::

### name

This is the name of the contract to index, it will use this name on the database on tables it generates, alongside
on generated rust code if you are using the rust project.

```yaml [rindexer.yaml]
name: rETHIndexer
description: My first rindexer project
repository: https://github.com/joshstevens19/rindexer
networks:
- name: ethereum
  chainId: 1
  rpcUrl: https://mainnet.infura.io/v3/your-infura-key
storage:
  postgres:
    name: ${DATABASE_NAME}
    user: ${DATABASE_USER}
    password: ${DATABASE_PASSWORD}
    host: ${DATABASE_HOST}
    port: ${DATABASE_PORT}
  csv:
    path: ./generated_csv
indexers:
- name: MyFirstIndexerExample
  contracts:
    - name: RocketPoolETH // [!code focus]
```

### details

The details for the contract mapping to the network and contract address.

#### network

The network name to listen for events on, this should match the network name in the networks section of the YAML.

```yaml [rindexer.yaml]
name: rETHIndexer
description: My first rindexer project
repository: https://github.com/joshstevens19/rindexer
networks:
- name: ethereum
  chainId: 1
  rpcUrl: https://mainnet.infura.io/v3/your-infura-key
storage:
  postgres:
    name: ${DATABASE_NAME}
    user: ${DATABASE_USER}
    password: ${DATABASE_PASSWORD}
    host: ${DATABASE_HOST}
    port: ${DATABASE_PORT}
  csv:
    path: ./generated_csv
indexers:
- name: MyFirstIndexerExample
  contracts:
    - name: RocketPoolETH
      details:
      - network: ethereum // [!code focus]
```

#### address

:::info
The address of the contract to listen for events on. If you wish to use a `filter` you can leave this blank.
:::

The contract address to listen for events on.

```yaml [rindexer.yaml]
name: rETHIndexer
description: My first rindexer project
repository: https://github.com/joshstevens19/rindexer
networks:
- name: ethereum
  chainId: 1
  rpcUrl: https://mainnet.infura.io/v3/your-infura-key
storage:
  postgres:
    name: ${DATABASE_NAME}
    user: ${DATABASE_USER}
    password: ${DATABASE_PASSWORD}
    host: ${DATABASE_HOST}
    port: ${DATABASE_PORT}
  csv:
    path: ./generated_csv
indexers:
- name: MyFirstIndexerExample
  contracts:
    - name: RocketPoolETH
      details:
      - network: ethereum
        address: 0xae78736cd615f374d3085123a210448e74fc6393 // [!code focus]
```

#### filter

:::info
This is optional, if you do not provide a filter `address` will be required above.
:::

If you wish to filter based on events only for example you want all transfer events from all contracts you can use the
filter.

#### event_name

The event name to filter on, it must match the ABI event name.

```yaml [rindexer.yaml]
name: rETHIndexer
description: My first rindexer project
repository: https://github.com/joshstevens19/rindexer
networks:
- name: ethereum
  chainId: 1
  rpcUrl: https://mainnet.infura.io/v3/your-infura-key
storage:
  postgres:
    name: ${DATABASE_NAME}
    user: ${DATABASE_USER}
    password: ${DATABASE_PASSWORD}
    host: ${DATABASE_HOST}
    port: ${DATABASE_PORT}
  csv:
    path: ./generated_csv
indexers:
- name: MyFirstIndexerExample
  contracts:
    - name: RocketPoolETH
      details:
      - network: ethereum
        filter: // [!code focus]
          event_name: Transfer // [!code focus]
```

#### indexed_1, indexed_2, indexed_3

:::info
This is optional, if you do not provide this it will filter on the event name only.
:::

The indexed fields to filter on, you can have up to 3 indexed fields to filter on.
The indexed 1,2,3 are based on the order they are mapped in with the event. So if you have 3 indexed fields in the event
you can filter on all 3 or 2 of them or 1 of them in any direction.

```yaml [rindexer.yaml]
name: rETHIndexer
description: My first rindexer project
repository: https://github.com/joshstevens19/rindexer
networks:
- name: ethereum
  chainId: 1
  rpcUrl: https://mainnet.infura.io/v3/your-infura-key
storage:
  postgres:
    name: ${DATABASE_NAME}
    user: ${DATABASE_USER}
    password: ${DATABASE_PASSWORD}
    host: ${DATABASE_HOST}
    port: ${DATABASE_PORT}
  csv:
    path: ./generated_csv
indexers:
- name: MyFirstIndexerExample
  contracts:
    - name: RocketPoolETH
      details:
      - network: ethereum
        filter:
          event_name: Transfer
          indexed_1: // [!code focus]
            - 0x4A1a2197f307222cD67A1762D9A352F64558d9Be // [!code focus]
```

#### startBlock

The block to start indexing from, you can use the deployed block if you wish to get everything.

```yaml [rindexer.yaml]
name: rETHIndexer
description: My first rindexer project
repository: https://github.com/joshstevens19/rindexer
networks:
- name: ethereum
  chainId: 1
  rpcUrl: https://mainnet.infura.io/v3/your-infura-key
storage:
  postgres:
    name: ${DATABASE_NAME}
    user: ${DATABASE_USER}
    password: ${DATABASE_PASSWORD}
    host: ${DATABASE_HOST}
    port: ${DATABASE_PORT}
  csv:
    path: ./generated_csv
indexers:
- name: MyFirstIndexerExample
  contracts:
    - name: RocketPoolETH
      details:
      - network: ethereum
       address: 0xae78736cd615f374d3085123a210448e74fc6393
       startBlock: 18600000 // [!code focus]
```

#### endBlock

:::info
This is optional, if you do not provide an end block it will index all the data and then live index as new blocks
come in.
:::

```yaml [rindexer.yaml]
name: rETHIndexer
description: My first rindexer project
repository: https://github.com/joshstevens19/rindexer
networks:
- name: ethereum
  chainId: 1
  rpcUrl: https://mainnet.infura.io/v3/your-infura-key
storage:
  postgres:
    name: ${DATABASE_NAME}
    user: ${DATABASE_USER}
    password: ${DATABASE_PASSWORD}
    host: ${DATABASE_HOST}
    port: ${DATABASE_PORT}
  csv:
    path: ./generated_csv
indexers:
- name: MyFirstIndexerExample
  contracts:
    - name: RocketPoolETH
      details:
      - network: ethereum
       address: 0xae78736cd615f374d3085123a210448e74fc6393
       startBlock: 18600000
       endBlock: 18718056 // [!code focus]
```


#### Multiple Networks

You can have multiple networks for the same contract, this is useful if you have a contract that is deployed on multiple
networks.

```yaml [rindexer.yaml]
name: rETHIndexer
description: My first rindexer project
repository: https://github.com/joshstevens19/rindexer
networks: // [!code focus]
- name: ethereum // [!code focus]
  chainId: 1 // [!code focus]
  rpcUrl: https://mainnet.infura.io/v3/your-infura-key // [!code focus]
- name: base // [!code focus]
  chainId: 8453 // [!code focus]
  rpcUrl: https://mainnet.base.org // [!code focus]
storage:
  postgres:
    name: ${DATABASE_NAME}
    user: ${DATABASE_USER}
    password: ${DATABASE_PASSWORD}
    host: ${DATABASE_HOST}
    port: ${DATABASE_PORT}
  csv:
    path: ./generated_csv
indexers:
- name: MyFirstIndexerExample
  contracts:
    - name: RocketPoolETH
      details: // [!code focus]
      - network: ethereum // [!code focus]
       address: 0xae78736cd615f374d3085123a210448e74fc6393 // [!code focus]
       startBlock: 18600000 // [!code focus]
       endBlock: 18718056 // [!code focus]
      - network: base // [!code focus]
       address: 0xba25348cd615f374d3085123a210448e74fa3333 // [!code focus]
       startBlock: 18118056 // [!code focus]
       endBlock: 18918056 // [!code focus]
```

### abi

The ABI of the contract pointing to the JSON file in the repository. It can be a relative path or a full path.

```yaml [rindexer.yaml]
name: rETHIndexer
description: My first rindexer project
repository: https://github.com/joshstevens19/rindexer
networks:
- name: ethereum
  chainId: 1
  rpcUrl: https://mainnet.infura.io/v3/your-infura-key
storage:
  postgres:
    name: ${DATABASE_NAME}
    user: ${DATABASE_USER}
    password: ${DATABASE_PASSWORD}
    host: ${DATABASE_HOST}
    port: ${DATABASE_PORT}
  csv:
    path: ./generated_csv
indexers:
- name: MyFirstIndexerExample
  contracts:
    - name: RocketPoolETH
      details:
      - network: ethereum
       address: 0xae78736cd615f374d3085123a210448e74fc6393
       startBlock: 18600000
       endBlock: 18718056
      abi: ./abis/RocketTokenRETH.abi.json // [!code focus]
```

### include_events

The events you wish to include in the indexer.

:::info
This is optional if you do not provide this it will include all events in the ABI.
:::

```yaml [rindexer.yaml]
name: rETHIndexer
description: My first rindexer project
repository: https://github.com/joshstevens19/rindexer
networks:
- name: ethereum
  chainId: 1
  rpcUrl: https://mainnet.infura.io/v3/your-infura-key
storage:
  postgres:
    name: ${DATABASE_NAME}
    user: ${DATABASE_USER}
    password: ${DATABASE_PASSWORD}
    host: ${DATABASE_HOST}
    port: ${DATABASE_PORT}
  csv:
    path: ./generated_csv
indexers:
- name: MyFirstIndexerExample
  contracts:
    - name: RocketPoolETH
      details:
      - network: ethereum
       address: 0xae78736cd615f374d3085123a210448e74fc6393
       startBlock: 18600000
       endBlock: 18718056
      abi: ./abis/RocketTokenRETH.abi.json
      include_events:  // [!code focus]
      - Transfer // [!code focus]
      - Approval // [!code focus]
```

### reorg_safe_distance

Reorgs can happen on the blockchains, this is when a block is removed from the chain and replaced with another block.
This can cause issues with the indexer indexed state if you turn `reorg_safe_distance` on it will keep a safe distance from the live
latest block to avoid any reorg issues.

Note if you are doing live indexing you will need to handle more advanced reorgs, support for advanced reorgs
is in the backlog for rindexer.

:::info
This is optional if you do not provide this it will index the latest blocks instantly.
:::

```yaml [rindexer.yaml]
name: rETHIndexer
description: My first rindexer project
repository: https://github.com/joshstevens19/rindexer
networks:
- name: ethereum
  chainId: 1
  rpcUrl: https://mainnet.infura.io/v3/your-infura-key
storage:
  postgres:
    name: ${DATABASE_NAME}
    user: ${DATABASE_USER}
    password: ${DATABASE_PASSWORD}
    host: ${DATABASE_HOST}
    port: ${DATABASE_PORT}
  csv:
    path: ./generated_csv
indexers:
- name: MyFirstIndexerExample
  contracts:
    - name: RocketPoolETH
      details:
      - network: ethereum
       address: 0xae78736cd615f374d3085123a210448e74fc6393
       startBlock: 18600000
       endBlock: 18718056
      abi: ./abis/RocketTokenRETH.abi.json
      include_events:
      - Transfer
      - Approval
      reorg_safe_distance: true // [!code focus]
```

### generate_csv

If you wish to generate a CSV file of the indexed data you can turn this on. This will be ignored if you do not have
the CSV storage enabled. By default if this is not supplied and the CSV storage is enabled it will generate a CSV file.

:::info
This is optional if you do not provide this it will generate a CSV file if the CSV storage is enabled.
:::

```yaml [rindexer.yaml]
name: rETHIndexer
description: My first rindexer project
repository: https://github.com/joshstevens19/rindexer
networks:
- name: ethereum
  chainId: 1
  rpcUrl: https://mainnet.infura.io/v3/your-infura-key
storage:
  postgres:
    name: ${DATABASE_NAME}
    user: ${DATABASE_USER}
    password: ${DATABASE_PASSWORD}
    host: ${DATABASE_HOST}
    port: ${DATABASE_PORT}
  csv:
    path: ./generated_csv
indexers:
- name: MyFirstIndexerExample
  contracts:
    - name: RocketPoolETH
      details:
      - network: ethereum
       address: 0xae78736cd615f374d3085123a210448e74fc6393
       startBlock: 18600000
       endBlock: 18718056
      abi: ./abis/RocketTokenRETH.abi.json
      include_events:
      - Transfer
      - Approval
      reorg_safe_distance: true
      generate_csv: true // [!code focus]
```